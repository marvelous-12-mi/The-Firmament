<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Synq - Share Your Moments</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Roboto',sans-serif;background:#fafafa;color:#262626;}
  .hidden{display:none;}
  /* Auth Pages */
  .auth-page{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;}
  .auth-container{width:100%;max-width:350px;}
  .auth-box{background:white;border:1px solid #dbdbdb;border-radius:8px;padding:40px;margin-bottom:10px;text-align:center;}
  .auth-logo h1{font-family:'Roboto',cursive;font-size:52px;font-weight:300;background:linear-gradient(45deg,#f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
  .auth-input{width:100%;padding:9px 8px 7px;font-size:12px;border:1px solid #dbdbdb;border-radius:3px;background:#fafafa;margin-bottom:6px;transition:border 0.2s;}
  .auth-input:focus{outline:none;border-color:#a8a8a8;background:white;}
  .auth-btn{width:100%;padding:7px 16px;background:#0095f6;color:white;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;margin-top:8px;transition:background 0.2s;}
  .auth-btn:hover{background:#1877f2;}
  .auth-btn:disabled{background:#b2dffc;cursor:not-allowed;}
  .auth-divider{display:flex;align-items:center;margin:20px 0;color:#8e8e8e;font-size:13px;font-weight:600;}
  .auth-divider::before,.auth-divider::after{content:'';flex:1;height:1px;background:#dbdbdb;}
  .auth-divider span{padding:0 18px;}
  .auth-switch{background:white;border:1px solid #dbdbdb;border-radius:8px;padding:24px;text-align:center;font-size:14px;}
  .auth-switch a{color:#0095f6;text-decoration:none;font-weight:600;cursor:pointer;}
  .message{padding:10px;margin-bottom:10px;border-radius:3px;font-size:14px;text-align:center;display:none;}
  .message.error{background:#ffeaea;color:#ed4956;}
  .message.success{background:#d4edda;color:#155724;}
  /* Main App */
  .app-container{display:none;}
  .nav-bar{background:white;border-bottom:1px solid #dbdbdb;position:fixed;top:0;left:0;right:0;z-index:1000;}
  .nav-content{max-width:935px;margin:0 auto;padding:0 20px;height:60px;display:flex;align-items:center;justify-content:space-between;}
  .nav-logo{font-family:'Roboto',cursive;font-size:32px;font-weight:300;background:linear-gradient(45deg,#f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;cursor:pointer;}
  .nav-search{position:relative;}
  .nav-search input{padding:6px 16px 6px 32px;background:#efefef;border:1px solid #dbdbdb;border-radius:8px;width:268px;font-size:14px;}
  .nav-search input:focus{outline:none;}
  .nav-search i{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#8e8e8e;font-size:12px;}
  .nav-icons{display:flex;gap:22px;align-items:center;}
  .nav-icon{font-size:24px;color:#262626;cursor:pointer;transition:transform 0.2s;}
  .nav-icon:hover{transform:scale(1.1);}
  .nav-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(45deg,#f09433,#dc2743);display:flex;align-items:center;justify-content:center;color:white;font-size:14px;font-weight:600;cursor:pointer;}
  /* Main Content */
  .main-content{max-width:935px;margin:0 auto;padding:88px 20px 0;display:flex;gap:28px;}
  .feed{flex:1;max-width:614px;}
  .sidebar{width:293px;position:sticky;top:88px;height:fit-content;}
  /* Stories */
  .stories{background:white;border:1px solid #dbdbdb;border-radius:8px;padding:16px;margin-bottom:24px;display:flex;gap:16px;overflow-x:auto;}
  .story{display:flex;flex-direction:column;align-items:center;cursor:pointer;min-width:56px;}
  .story-ring{width:56px;height:56px;border-radius:50%;background:linear-gradient(45deg,#f09433,#dc2743,#bc1888);padding:2px;margin-bottom:8px;}
  .story-avatar{width:100%;height:100%;border-radius:50%;background:white;display:flex;align-items:center;justify-content:center;border:2px solid white;}
  .story-avatar-inner{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;font-size:18px;}
  .story-username{font-size:12px;color:#262626;max-width:56px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
  /* Post Card */
  .post{background:white;border:1px solid #dbdbdb;border-radius:8px;margin-bottom:24px;}
  .post-header{padding:14px 16px;display:flex;align-items:center;justify-content:space-between;}
  .post-user{display:flex;align-items:center;gap:12px;}
  .post-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(45deg,#f09433,#dc2743);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;font-size:14px;}
  .post-username{font-size:14px;font-weight:600;color:#262626;}
  .post-more{background:none;border:none;cursor:pointer;font-size:20px;color:#262626;}
  .post-content{padding:0 16px 8px;font-size:14px;line-height:1.5;}
  .post-actions{padding:6px 16px;display:flex;gap:16px;align-items:center;}
  .post-action{background:none;border:none;cursor:pointer;font-size:24px;color:#262626;transition:opacity 0.2s;}
  .post-action:hover{opacity:0.5;}
  .post-action.liked{color:#ed4956;}
  .post-stats{padding:0 16px 8px;font-size:14px;font-weight:600;}
  .post-time{padding:0 16px 16px;font-size:10px;color:#8e8e8e;text-transform:uppercase;letter-spacing:0.2px;}
  .post-comment-section{border-top:1px solid #efefef;padding:16px;display:flex;gap:12px;}
  .post-comment-input{flex:1;border:none;font-size:14px;color:#262626;}
  .post-comment-input:focus{outline:none;}
  .post-comment-btn{background:none;border:none;color:#0095f6;font-size:14px;font-weight:600;cursor:pointer;}
  .post-comment-btn:disabled{opacity:0.3;cursor:not-allowed;}
  /* Comments */
  .comments{padding:0 16px;}
  .comment{font-size:14px;margin-bottom:8px;line-height:1.5;}
  .comment-username{font-weight:600;margin-right:6px;}
  .comment-time{font-size:12px;color:#8e8e8e;margin-left:8px;}
  /* Modal */
  .modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.65);z-index:2000;align-items:center;justify-content:center;}
  .modal.active{display:flex;}
  .modal-content{background:white;border-radius:12px;width:90%;max-width:500px;max-height:80vh;overflow:hidden;}
  .modal-header{padding:16px;border-bottom:1px solid #dbdbdb;display:flex;justify-content:space-between;align-items:center;}
  .modal-title{font-size:16px;font-weight:600;}
  .modal-close{background:none;border:none;font-size:24px;cursor:pointer;color:#262626;}
  .modal-body{padding:16px;}
  .modal-textarea{width:100%;min-height:200px;border:none;font-size:16px;font-family:inherit;resize:none;}
  .modal-textarea:focus{outline:none;}
  .modal-footer{padding:16px;border-top:1px solid #dbdbdb;}
  .modal-btn{width:100%;padding:8px;background:#0095f6;color:white;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;}
  .modal-btn:disabled{background:#b2dffc;cursor:not-allowed;}
  /* Responsive */
  @media (max-width:768px){.nav-search{display:none;}.sidebar{display:none;}.feed{max-width:100%;}.main-content{padding-top:76px;}}
</style>
</head>
<body>

<!-- Login Page -->
<div id="loginPage" class="auth-page">
  <div class="auth-container">
    <div class="auth-box">
      <div class="auth-logo"><h1>Synq</h1></div>
      <div id="loginMessage" class="message"></div>
      <form id="loginForm">
        <input type="email" id="loginEmail" class="auth-input" placeholder="Email" required>
        <input type="password" id="loginPassword" class="auth-input" placeholder="Password" required>
        <button type="submit" class="auth-btn">Log in</button>
      </form>
      <div class="auth-divider"><span>OR</span></div>
    </div>
    <div class="auth-switch">Don't have an account? <a id="goToSignup">Sign up</a></div>
  </div>
</div>

<!-- Signup Page -->
<div id="signupPage" class="auth-page hidden">
  <div class="auth-container">
    <div class="auth-box">
      <div class="auth-logo"><h1>Synq</h1></div>
      <p style="text-align:center;color:#8e8e8e;font-size:17px;font-weight:600;margin-bottom:20px;">Sign up to see photos and videos from your friends.</p>
      <div id="signupMessage" class="message"></div>
      <form id="signupForm">
        <input type="email" id="signupEmail" class="auth-input" placeholder="Email" required>
        <input type="text" id="signupUsername" class="auth-input" placeholder="Username" required minlength="3">
        <input type="password" id="signupPassword" class="auth-input" placeholder="Password" required minlength="6">
        <button type="submit" class="auth-btn">Sign up</button>
      </form>
    </div>
    <div class="auth-switch">Have an account? <a id="goToLogin">Log in</a></div>
  </div>
</div>

<!-- Main App -->
<div id="mainApp" class="app-container">
  <nav class="nav-bar">
    <div class="nav-content">
      <div class="nav-logo">Synq</div>
      <div class="nav-search"><i class="fas fa-search"></i><input type="text" placeholder="Search"></div>
      <div class="nav-icons">
        <i class="far fa-home nav-icon"></i>
        <i class="far fa-paper-plane nav-icon"></i>
        <i class="far fa-plus-square nav-icon" id="openCreateModal"></i>
        <i class="far fa-compass nav-icon"></i>
        <i class="far fa-heart nav-icon"></i>
        <div class="nav-avatar" id="navAvatar">U</div>
        <button id="logoutBtn" style="background:none;border:none;color:#262626;cursor:pointer;font-size:14px;font-weight:600;">Logout</button>
      </div>
    </div>
  </nav>

  <div class="main-content">
    <div class="feed">
      <div class="stories">
        <div class="story">
          <div class="story-ring">
            <div class="story-avatar"><div class="story-avatar-inner">+</div></div>
          </div>
          <span class="story-username">Your story</span>
        </div>
      </div>
      <div id="postsContainer"></div>
    </div>

    <div class="sidebar">
      <div class="user-card">
        <div class="user-card-avatar" id="sidebarAvatar">U</div>
        <div class="user-card-info">
          <div class="user-card-username" id="sidebarUsername">username</div>
          <div class="user-card-name" id="sidebarEmail">User Name</div>
        </div>
      </div>

      <div class="suggestions">
        <div class="suggestions-header"><span class="suggestions-title">Suggestions For You</span></div>
        <div id="suggestionsContainer"></div>
      </div>

      <div class="footer">
        <a href="#">About</a><a href="#">Help</a><a href="#">Press</a><a href="#">API</a><a href="#">Jobs</a><a href="#">Privacy</a><a href="#">Terms</a>
        <div style="margin-top:16px;">Â© 2024 SYNQ</div>
      </div>
    </div>
  </div>
</div>

<!-- Create Post Modal -->
<div id="createModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="modal-title">Create new post</span>
      <button class="modal-close" id="closeModal">&times;</button>
    </div>
    <div class="modal-body">
      <textarea id="postTextarea" class="modal-textarea" placeholder="Write a caption..."></textarea>
    </div>
    <div class="modal-footer">
      <button id="sharePostBtn" class="modal-btn">Share</button>
    </div>
  </div>
</div>

<script>
const supabase = supabase.createClient(
  'https://qpfjchiucjhfvyohqhih.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFwZmpjaGl1Y2poZnZ5b2hxaGloIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MDczMjksImV4cCI6MjA3NTQ4MzMyOX0.kcx9Sr7qGbWudJdf155tXg0gWWX6P1RYavo-lKCoQkU'
);

let currentUser = null;
let profiles = {};
let userLikes = new Set();

document.getElementById('goToSignup').onclick = () => showPage('signup');
document.getElementById('goToLogin').onclick = () => showPage('login');
document.getElementById('logoutBtn').onclick = async () => {await supabase.auth.signOut();};

document.getElementById('loginForm').onsubmit = async e => {
  e.preventDefault();
  const email = document.getElementById('loginEmail').value.trim();
  const password = document.getElementById('loginPassword').value;
  const { error } = await supabase.auth.signInWithPassword({ email, password });
  if(error) showMessage('loginMessage', error.message,'error');
};

document.getElementById('signupForm').onsubmit = async e => {
  e.preventDefault();
  const email = document.getElementById('signupEmail').value.trim();
  const username = document.getElementById('signupUsername').value.trim();
  const password = document.getElementById('signupPassword').value;
  const { error } = await supabase.auth.signUp({ email, password, options:{data:{username}}});
  if(error){showMessage('signupMessage', error.message,'error');return;}
  showMessage('signupMessage','Account created! Check email.','success');
  setTimeout(()=>showPage('login'),2000);
};

document.getElementById('openCreateModal').onclick = () => document.getElementById('createModal').classList.add('active');
document.getElementById('closeModal').onclick = () => {document.getElementById('createModal').classList.remove('active');document.getElementById('postTextarea').value='';};
document.getElementById('sharePostBtn').onclick = async () => {
  const content = document.getElementById('postTextarea').value.trim();
  if(!content) return;
  await supabase.from('posts').insert([{user_id:currentUser.id, content}]);
  document.getElementById('createModal').classList.remove('active');
  document.getElementById('postTextarea').value='';
  loadPosts();
};

supabase.auth.onAuthStateChange((event, session) => {
  if(session?.user) {currentUser = session.user; loadApp();}
  else showPage('login');
});

async function loadApp(){
  showPage('app');
  const avatar = currentUser.user_metadata?.username?.[0]?.toUpperCase() || 'U';
  document.getElementById('navAvatar').textContent = avatar;
  document.getElementById('sidebarAvatar').textContent = avatar;
  document.getElementById('sidebarUsername').textContent = currentUser.user_metadata?.username || 'username';
  document.getElementById('sidebarEmail').textContent = currentUser.email;
  await loadPosts();
}

function showPage(page){
  document.getElementById('loginPage').classList.add('hidden');
  document.getElementById('signupPage').classList.add('hidden');
  document.getElementById('mainApp').style.display = 'none';
  if(page==='login') document.getElementById('loginPage').classList.remove('hidden');
  if(page==='signup') document.getElementById('signupPage').classList.remove('hidden');
  if(page==='app') document.getElementById('mainApp').style.display='block';
}

function showMessage(id,msg,type){const el=document.getElementById(id);el.textContent=msg;el.className='message '+type;el.style.display='block';setTimeout(()=>el.style.display='none',4000);}

async function loadPosts(){
  const {data,error} = await supabase.from('posts').select('*, profiles(username)').order('created_at',{ascending:false});
  if(error) return console.error(error);
  const container = document.getElementById('postsContainer');
  container.innerHTML='';
  data.forEach(post=>{
    const postEl = document.createElement('div');
    postEl.className='post';
    postEl.innerHTML=`
      <div class="post-header">
        <div class="post-user">
          <div class="post-avatar">${post.profiles?.username?.[0]?.toUpperCase()||'U'}</div>
          <div class="post-username">${post.profiles?.username||'username'}</div>
        </div>
      </div>
      <div class="post-content">${post.content}</div>
      <div class="post-actions">
        <button class="post-action like-btn" data-id="${post.id}"><i class="far fa-heart"></i></button>
      </div>
      <div class="post-time">${new Date(post.created_at).toLocaleString()}</div>
    `;
    container.appendChild(postEl);
  });
  document.querySelectorAll('.like-btn').forEach(btn=>{
    btn.onclick = async () => {
      const id = btn.dataset.id;
      await supabase.from('likes').insert([{post_id:id, user_id:currentUser.id}]);
      btn.querySelector('i').classList.replace('far','fas');
    };
  });
}
</script>

</body>
</html>
