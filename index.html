<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SuperIntellect</title>
  <style>
    :root {
      --bg-dark: #000;
      --panel-dark: #1a1a1a;
      --text-light: #fefefe;
      --accent: #facc15;
      --accent-glow: rgba(250, 204, 21, 0.3);
    }

    body {
      font-family: "Segoe UI", sans-serif;
      background: var(--bg-dark);
      color: var(--text-light);
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      min-height: 100vh;
    }

    h1 {
      margin: 20px 0;
      color: var(--accent);
      text-shadow: 0 0 15px var(--accent);
      font-size: 2.2rem;
      text-align: center;
    }

    #chat {
      flex: 1;
      width: 90%;
      max-width: 900px;
      margin: 10px;
      padding: 20px;
      background: var(--panel-dark);
      border-radius: 14px;
      overflow-y: auto;
      box-shadow: 0 0 25px var(--accent-glow);
    }

    .msg {
      margin: 10px 0;
      line-height: 1.5;
      word-wrap: break-word;
    }

    .user {
      color: var(--accent);
      text-align: right;
    }

    .bot {
      color: var(--text-light);
      text-align: left;
    }

    #input-area {
      width: 90%;
      max-width: 900px;
      display: flex;
      margin: 20px 0;
    }

    #input {
      flex: 1;
      padding: 14px;
      font-size: 1em;
      border-radius: 10px 0 0 10px;
      border: none;
      outline: none;
      background: #333;
      color: var(--text-light);
    }

    #send {
      padding: 14px 20px;
      border: none;
      background: var(--accent);
      color: #000;
      border-radius: 0 10px 10px 0;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s ease;
    }

    #send:hover {
      background: #fde047;
    }

    canvas {
      margin-top: 20px;
      border-radius: 12px;
      box-shadow: 0 0 20px var(--accent-glow);
    }

    @media screen and (max-width: 600px) {
      h1 { font-size: 1.6rem; }
      #input-area { flex-direction: column; }
      #input, #send {
        width: 100%;
        border-radius: 10px;
        margin: 5px 0;
      }
    }
  </style>
</head>
<body>
  <h1>🤖 SuperIntellect</h1>
  <div id="chat"></div>
  <div id="input-area">
    <input id="input" type="text" placeholder="Ask me anything..." />
    <button id="send">Send</button>
  </div>
  <canvas id="canvas" width="400" height="300"></canvas>

  <script>
    const chat = document.getElementById("chat");
    const input = document.getElementById("input");
    const send = document.getElementById("send");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    let memory = {
      facts: [],
      definitions: {},
      conditionals: []
    };

    function addMessage(text, cls) {
      const div = document.createElement("div");
      div.className = "msg " + cls;
      div.innerHTML = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    function drawImage(prompt) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "#facc15";
      ctx.font = "18px Segoe UI";
      ctx.fillText("🖼️ " + prompt, 20, 40);
      ctx.strokeStyle = "#facc15";
      ctx.strokeRect(50, 80, 300, 180);
      ctx.fillText("Symbolic image frame", 120, 180);
    }

    function deduce() {
      let newFacts = [];
      for (let f1 of memory.facts) {
        for (let f2 of memory.facts) {
          if (f1.predicate === f2.subject) {
            const deduced = { subject: f1.subject, predicate: f2.predicate };
            if (!memory.facts.some(f => f.subject === deduced.subject && f.predicate === deduced.predicate)) {
              memory.facts.push(deduced);
              newFacts.push(deduced);
            }
          }
        }
      }
      return newFacts;
    }

    async function fetchFact(query) {
      try {
        const res = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`);
        const data = await res.json();
        return data.extract || "I couldn't find anything on that.";
      } catch {
        return "Lookup failed. Try again later.";
      }
    }

    async function reason(msg) {
      const lower = msg.toLowerCase().trim();

      if (lower.startsWith("define ")) {
        const [term, def] = msg.slice(7).split(" as ");
        if (term && def) {
          memory.definitions[term.trim()] = def.trim();
          return `Stored: ${term.trim()} means "${def.trim()}".`;
        }
        return "Use 'define [term] as [definition]'.";
      }

      if (lower.startsWith("what is ")) {
        const term = lower.replace("what is ", "").trim();
        if (memory.definitions[term]) {
          return `${term} means "${memory.definitions[term]}"`;
        }
        return await fetchFact(term);
      }

      if (lower.includes(" is ") && !lower.startsWith("what is")) {
        const [sub, pred] = msg.split(" is ");
        memory.facts.push({ subject: sub.trim(), predicate: pred.trim() });
        return `Got it: ${sub.trim()} is ${pred.trim()}.`;
      }

      if (lower === "deduce") {
        const newFacts = deduce();
        if (newFacts.length > 0) {
          return "Deduced: " + newFacts.map(f => `${f.subject} is ${f.predicate}`).join("; ");
        }
        return "No new deductions available.";
      }

      if (lower.startsWith("if ") && lower.includes(" then ")) {
        const [condition, result] = lower.slice(3).split(" then ");
        memory.conditionals.push({ if: condition.trim(), then: result.trim() });
        return `Stored: If ${condition.trim()}, then ${result.trim()}.`;
      }

      if (lower === "show logic") {
        let output = "🧠 Logic Inventory:\n";
        output += memory.facts.map(f => `${f.subject} → ${f.predicate}`).join("\n");
        output += "\nDefinitions:\n" + Object.entries(memory.definitions).map(([k, v]) => `${k}: ${v}`).join("\n");
        output += "\nConditionals:\n" + memory.conditionals.map(c => `If ${c.if}, then ${c.then}`).join("\n");
        return output || "I'm still learning. Teach me something!";
      }

      if (lower.startsWith("image of ")) {
        const subject = msg.slice(9).trim();
        drawImage(subject);
        return `Here's a symbolic image of "${subject}".`;
      }

      if (/^[\d\s\+\-\*\/\.\(\)]+$/.test(msg)) {
        try {
          return `The answer is ${eval(msg)}`;
        } catch {
          return "I can't calculate that.";
        }
      }

      const fallback = [
        `Hmm… "${msg}" sounds interesting. Let's explore it.`,
        `I'm not sure yet, but you can teach me.`,
        `Let's think about "${msg}" together.`,
        `That's a deep one. What do you think?`
      ];
      return fallback[Math.floor(Math.random() * fallback.length)];
    }

    async function handleInput() {
      const text = input.value.trim();
      if (!text) return;
      addMessage(text, "user");
      input.value = "";
      const reply = await reason(text);
      addMessage(reply, "bot");
    }

    send.addEventListener("click", handleInput);
    input.addEventListener("keydown", e => {
      if (e.key === "Enter") handleInput();
    });
  </script>
</body>
</html>
