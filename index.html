<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SuperIntellect</title>
<style>
:root {
  --bg-dark: #0f172a;
  --panel-dark: #1e293b;
  --text-light: #e2e8f0;
  --accent: #38bdf8;
  --accent-glow: rgba(56,189,248,0.4);
}

body {
  font-family: "Segoe UI", sans-serif;
  background: var(--bg-dark);
  color: var(--text-light);
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 0;
  min-height: 100vh;
}

h1 {
  margin: 20px 0;
  color: var(--accent);
  text-shadow: 0 0 15px var(--accent);
  font-size: 2rem;
  text-align: center;
}

#chat {
  flex: 1;
  width: 90%;
  max-width: 900px;
  margin: 10px;
  padding: 20px;
  background: var(--panel-dark);
  border-radius: 14px;
  overflow-y: auto;
  box-shadow: 0 0 25px var(--accent-glow);
}

.msg {
  margin: 10px 0;
  line-height: 1.4;
  word-wrap: break-word;
}

.user {
  color: var(--accent);
  text-align: right;
}

.bot {
  color: var(--text-light);
  text-align: left;
}

#input-area {
  width: 90%;
  max-width: 900px;
  display: flex;
  margin: 10px 0 20px;
}

#input {
  flex: 1;
  padding: 14px;
  font-size: 1em;
  border-radius: 10px 0 0 10px;
  border: none;
  outline: none;
  background: #334155;
  color: var(--text-light);
}

#send {
  padding: 14px 20px;
  border: none;
  background: var(--accent);
  color: #000;
  border-radius: 0 10px 10px 0;
  cursor: pointer;
  font-weight: bold;
}

@media screen and (max-width: 600px) {
  h1 { font-size: 1.5rem; }
  #input-area { flex-direction: column; }
  #input, #send {
    width: 100%;
    border-radius: 10px;
    margin: 5px 0;
  }
}
</style>
</head>
<body>
<h1>ðŸ¤– SuperIntellect</h1>
<div id="chat"></div>
<div id="input-area">
  <input id="input" type="text" placeholder="Talk to me..." />
  <button id="send">Send</button>
</div>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const send = document.getElementById("send");

let memory = JSON.parse(localStorage.getItem("si_memory")) || {
  facts: [],
  translations: {},
  concepts: {},
  conditionals: []
};

function saveMemory(){ localStorage.setItem("si_memory", JSON.stringify(memory)); }
function cap(str){ return str.charAt(0).toUpperCase()+str.slice(1); }

function deduce() {
  let deductions = [];
  for(let f1 of memory.facts){
    for(let f2 of memory.facts){
      if(f1.predicate.toLowerCase() === f2.subject.toLowerCase()){
        const d = {subject:f1.subject, predicate:f2.predicate};
        if(!memory.facts.some(f=>f.subject===d.subject && f.predicate===d.predicate)){
          memory.facts.push(d);
          deductions.push(d);
        }
      }
    }
  }
  if(deductions.length>0) saveMemory();
  return deductions;
}

async function fetchFact(query){
  try {
    const res = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`);
    const data = await res.json();
    return data.extract || "I couldn't find anything on that.";
  } catch {
    return "Lookup failed. Try again later.";
  }
}

function smartFallback(msg){
  const options=[
    `Hmmâ€¦ "${msg}" sounds fascinating. Let's think together.`,
    `Interesting! Could you clarify a bit more?`,
    `I donâ€™t know that yet, but I can learn if you teach me.`,
    `Let's reason about "${msg}" and see where it leads.`
  ];
  return options[Math.floor(Math.random()*options.length)];
}

async function reason(msg){
  const lower = msg.toLowerCase().trim();

  if(/^(hi|hello|hey|yo)/.test(lower)) return "Hey! Cool to see you. What shall we talk about?";

  if(lower.includes(" is ") && !lower.startsWith("what is") && !lower.includes(" in french")){
    const [sub,pred]=msg.split(" is ");
    memory.facts.push({subject:sub.trim(), predicate:pred.trim()});
    saveMemory();
    return `Got it: ${cap(sub.trim())} is ${pred.trim()}.`;
  }

  if(lower.includes(" in french is ")){
    const [word,translation] = msg.split(" in french is ");
    memory.translations[word.trim().toLowerCase()]=translation.trim().toLowerCase();
    saveMemory();
    return `Noted: "${word.trim()}" in French is "${translation.trim()}"`;
  }

  if(lower.includes(" in french") && lower.startsWith("what is ")){
    const word = lower.replace("what is ","").replace(" in french","").trim().toLowerCase();
    if(memory.translations[word]) return `"${word}" in French is "${memory.translations[word]}"`;
    return `I don't know how to say "${word}" in French yet. You can teach me like "chicken in French is poule".`;
  }

  if(lower.includes("remember")){
    let output="";
    if(memory.facts.length>0) output+="Facts: "+memory.facts.map(f=>`${f.subject} is ${f.predicate}`).join("; ")+"\n";
    if(Object.keys(memory.translations).length>0) output+="Translations: "+Object.entries(memory.translations).map(([w,t])=>`${w}=${t}`).join("; ")+"\n";
    if(Object.keys(memory.concepts).length>0) output+="Definitions: "+Object.entries(memory.concepts).map(([k,v])=>`${k}: ${v}`).join("; ")+"\n";
    if(memory.conditionals.length>0) output+="Conditionals: "+memory.conditionals.map(c=>`If ${c.if}, then ${c.then}`).join("; ");
    return output || "I haven't stored any facts yet.";
  }

  if(lower.includes("deduce")){
    const ded = deduce();
    if(ded.length>0) return "From deduction: "+ded.map(d=>`${d.subject} is ${d.predicate}`).join("; ");
    return "No new deductions can be made yet.";
  }

  if(lower.startsWith("define ")){
    const [concept, def] = msg.slice(7).split(" as ");
    if(concept && def){
      memory.concepts[concept.trim()]=def.trim();
      saveMemory();
      return `Definition stored: ${concept.trim()} â†’ ${def.trim()}.`;
    }
  }

  if(lower.startsWith("what is ") && !lower.includes(" in french")){
    const query = lower.replace("what is ","").trim();
    if(memory.concepts[query]) return `${query} is ${memory.concepts[query]}`;
    return await fetchFact(query);
  }

  if(lower.startsWith("lookup ")){
    const topic = msg.slice(7).trim();
    return await fetchFact(topic);
  }

  if(lower.startsWith("learn about ")){
    const topic = msg.slice(12).trim();
    const info = await fetchFact(topic);
    memory.concepts[topic] = info;
    saveMemory();
    return `Learned: ${topic} â†’ ${info}`;
  }

  if(lower.startsWith("if ") && lower.includes(" then ")){
    const [condition,result] = lower.slice(3).split(" then ");
    memory.conditionals.push({if:condition.trim(), then:result.trim()});
    saveMemory();
    return `Stored: If ${condition.trim()}, then ${result.trim()}.`;
  }

  if(lower==="show logic"){
    let output = "ðŸ§  Logic Inventory:\n";
    output += memory.facts.map(f=>`${f.subject} â†’ ${f.predicate}`).join("\n");
    output += "\nDefinitions:\n" + Object.entries(memory.concepts).map(([k,v])=>`${k}: ${v}`).join("\n");
    output += "\nConditionals:\n" + memory.conditionals.map(c=>`If ${c.if}, then ${c.then}`).join("\n");
    output += "\nTranslations:\n" + Object.entries(memory.translations).map(([w,t]) => `${w} = ${t}`).join("\n");
    return output || "I'm still learning. Teach me something!";
  }

  if(/^[\d\s\+\-\*\/\.\(\)]+$/.test(msg)){
    try{ return `The answer is ${eval(msg)}`; }catch{return "I can't calculate that.";}
  }

  return smartFallback(msg);
}

function addMessage(text,cls){ 
  const div=document.createElement("div"); 
  div.className="msg "+cls; 
  div.innerText=text; 
  chat.appendChild(div); 
  chat.scrollTop = chat.scrollHeight; 
}

async function handleInput(){
  const text = input.value.trim();
  if(!text) return;
  addMessage(text, "user");
  input.value = "";
  const reply = await reason(text);
  addMessage(reply, "bot");
}

send.addEventListener("click", handleInput);
input.addEventListener("keydown", e => { if(e.key === "Enter") handleInput(); });
</script>
</body>
</html>
